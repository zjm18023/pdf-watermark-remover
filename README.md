# PDF批量去水印工具

一个功能强大、界面美观的PDF批量去水印工具，支持区域删除、文字删除、页面排除等多种去水印方式。

## ✨ 功能特性

### 核心功能
- 📄 **批量处理** - 支持同时处理多个PDF文件，提高工作效率
- 🎯 **区域删除** - 可视化选择PDF页面中的任意区域进行删除
- 📝 **文字删除** - 通过输入文字内容，自动搜索并删除所有匹配的文字
- 📋 **页面排除** - 灵活设置需要排除的页面范围，支持多种格式（如：1-5, 10, 15-20）
- 👁️ **实时预览** - 处理前可预览PDF页面，精确选择需要删除的区域
- 📊 **处理日志** - 详细记录每个文件的处理状态和结果

### 区域删除功能
- **当前页面删除** - 仅在选中的页面删除指定区域
- **所有页面删除** - 在所有页面删除相同位置的区域
- **所有文件删除** - 批量处理时，在所有文件的所有页面删除相同区域

### 界面特性
- 🎨 **现代化UI** - 基于CustomTkinter构建的美观界面
- 📱 **响应式布局** - 自适应窗口大小，支持最大化
- 🔍 **PDF预览** - 内置PDF查看器，支持缩放和翻页

## 🛠️ 技术栈

- **Python 3.12.3 - 主要编程语言
- **PyMuPDF (fitz)** - PDF文件处理和渲染
- **CustomTkinter** - 现代化GUI框架
- **Pillow (PIL)** - 图像处理
- **CTkMessagebox** - 消息框组件

## 📦 安装说明

### 环境要求
- Python 3.12 或更高版本
- Windows / macOS / Linux

### 安装步骤

1. **克隆仓库**
```bash
git clone https://github.com/zjm18023/pdf-watermark-remover.git
cd pdf-watermark-remover
```

2. **创建虚拟环境（推荐）**
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

3. **安装依赖**
```bash
pip install -r requirements.txt
```

## 🚀 使用方法

### 启动程序
```bash
python main.py
```

### 基本操作流程

1. **添加PDF文件**
   - 点击"📄 打开文件"按钮，选择单个PDF文件
   - 或点击"📁 打开文件夹"按钮，批量添加文件夹中的所有PDF文件

2. **设置删除区域（可选）**
   - 在文件列表中点击"选择区域"按钮
   - 在预览窗口中框选需要删除的区域
   - 选择应用范围：当前页面 / 所有页面 / 所有文件

3. **设置删除文字（可选）**
   - 在"文字删除"面板中输入需要删除的文字
   - 可以添加多个文字条目
   - 文字删除会应用到所有文件的所有页面

4. **设置页面排除（可选）**
   - 在"页面排除"面板中输入需要排除的页面范围
   - 支持格式：`1-5, 10, 15-20` 或 `1,3,5`

5. **处理文件**
   - **处理选中文件**：处理当前选中的单个文件
   - **处理全部文件**：批量处理列表中的所有文件
   - 处理完成后，文件会保存到原文件同目录，文件名添加`_去水印`后缀

## 📁 项目结构

```
qushuiyin/
├── main.py                 # 程序入口
├── config.py              # 配置文件管理
├── requirements.txt       # 依赖包列表
├── LICENSE                # 许可证文件
├── core/                  # 核心功能模块
│   ├── __init__.py
│   ├── pdf_handler.py     # PDF文件处理
│   ├── watermark_remover.py  # 水印删除逻辑
│   └── file_manager.py    # 文件管理
├── gui/                   # GUI界面模块
│   ├── __init__.py
│   ├── main_window.py     # 主窗口
│   ├── region_dialog.py   # 区域选择对话框
│   ├── pdf_viewer.py      # PDF预览器
│   ├── process_log_dialog.py  # 处理日志对话框
│   ├── rounded_button.py  # 圆角按钮组件
│   ├── rounded_frame.py   # 圆角框架组件
│   └── gradient_frame.py  # 渐变框架组件
└── utils/                 # 工具模块
    ├── __init__.py
    ├── config_manager.py  # 配置管理
    ├── file_utils.py      # 文件工具
    ├── page_parser.py     # 页面范围解析
    └── window_utils.py    # 窗口工具
```

## ⚙️ 配置说明

程序配置文件保存在用户目录下的 `.pdf-watermark-remover/config.json`，包含以下配置项：

- **窗口设置**：窗口大小、位置、最大化状态
- **主题设置**：浅色/深色模式、颜色主题
- **PDF设置**：DPI、默认缩放比例
- **删除模式**：区域删除模式、文字删除模式

## 📝 使用示例

### 示例1：删除单个PDF的水印区域
1. 打开PDF文件
2. 点击"选择区域"
3. 在预览窗口中框选水印区域
4. 选择"当前页面"或"所有页面"
5. 点击"处理选中文件"

### 示例2：批量删除多个PDF中的文字
1. 打开包含多个PDF的文件夹
2. 在"文字删除"面板输入需要删除的文字（如："水印"、"机密"等）
3. 点击"处理全部文件"

### 示例3：排除特定页面
1. 添加PDF文件
2. 在"页面排除"输入框中输入：`1, 3, 5-10`
3. 设置删除区域或文字
4. 处理文件（第1、3、5-10页不会被处理）

## ⚠️ 注意事项

1. **备份文件**：处理前建议备份原始PDF文件
2. **文件格式**：仅支持PDF格式文件
3. **处理时间**：大文件或批量处理可能需要较长时间

## 📄 许可证

本项目采用 [MIT License](LICENSE) 许可证。

## 👤 作者

**蓝胖子不胖**

---

⭐ 如果这个项目对你有帮助，请给个Star支持一下！

